<!DOCTYPE html>
<html lang="en" class="m-0 p-0 w-screen min-h-screen bg-navy-dark"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Subdomain Takeover | OffSec Wiki</title>
        <meta name="description" content="Subdomain Takeover is a malicious activity that the victim’s subdomain allows attackers to control and impersonate.">
        
        <link rel="icon" type="image/x-icon" href="/img/favicon-32.png">
        <link rel="stylesheet" href="/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/styles.css">
        <link rel="stylesheet" href="/css/carbonads.css">
        
        <script type="text/javascript" src="/js/exploit.js"></script>
        

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@muhammdhaidari">
        <meta name="twitter:creator" content="@muhammdhaidari">
        <meta property="og:url" content="https://offsec.PenTest.tools/exploit/dns/subdomain-takeover/">
        <meta property="og:title" content="Subdomain Takeover | OffSec Wiki">
        <meta property="og:description" content="Subdomain Takeover is a malicious activity that the victim’s subdomain allows attackers to control and impersonate.">
        <meta property="og:image" content="https://offsec.PenTest.tools/img/screenshot.png">
        
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-RR6XYHYTQ9"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RR6XYHYTQ9');
        </script>
    <script type="text/javascript" src="/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded', () => { new PagefindUI({"element":"#search","showImages":false,"showEmptyFilters":true,"resetStyles":true,"bundlePath":"/pagefind/","baseUrl":"/"}); });</script><link rel="stylesheet" href="/codecopy/codecopy.css"><script type="text/javascript" src="/codecopy/codecopy.js"></script></head>

    <body class="m-0 p-0 w-screen min-h-screen text-basic text-white text-sm">

        <header class="sticky top-0 w-full h-[70px] z-20 bg-gradient-to-r from-pink-dark">
    <div class="mx-auto w-full sm:w-2/3 h-full flex justify-around items-center">
        <div class="w-full h-full p-2 flex items-center space-x-3">
            <a href="/" class="hidden sm:block">
                <span class="text-base text-white font-bold">OFFSEC Wiki</span>
            </a>
            
            <div id="search"></div>
        </div>

        
        <div class="hidden sm:flex w-full h-full p-2 items-center justify-center space-x-3">
            
            <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" alt="GitHub">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-white w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>
            </a>
            
            <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" alt="Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-sky w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"></path></svg>
            </a>
        </div>
    </div>
</header>

<div id="search_bg" class="fixed top-0 left-0 w-full z-10 h-full bg-black opacity-50 hidden"></div>


<script>
    window.addEventListener('DOMContentLoaded', () => {
        //Display the black filter when searching
        const searchBgElem = document.getElementById("search_bg");
        const drawerElem = document.querySelector(".pagefind-ui__drawer");
        const inputElem = document.querySelector(".pagefind-ui__search-input");

        if (searchBgElem) {
            searchBgElem.addEventListener('click', () => {
                searchBgElem.classList.add("hidden");
                drawerElem.style.visibility = "hidden";
                drawerElem.style.opacity = 0;
            });
        }

        inputElem.addEventListener('focus', () => {
            if (searchBgElem) {
                searchBgElem.classList.remove("hidden");
                drawerElem.style.visibility = "visible";
                drawerElem.style.opacity = 1;
            }
        });
    });
</script>

        <main class="w-full h-full">
            <div class="block sm:grid grid-cols-[320px_minmax(400px,_1fr)_280px] py-2">

    
    <div id="exploit-leftside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3">
        <div class="w-full">
            <div id="exploit-related">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">
                    Exploits related to Dns
                </h4>
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Others</h4>
                    

                    
                        
                            <div class="my-3">
                            
                                <a href="/exploit/dns/dns-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                    DNS (Domain Name Systems) Pentesting
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <span id="scroll-target" class="text-sm text-white">Subdomain Takeover</span>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/dns/multicast-dns-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                    mDNS (Multicast DNS) Pentesting
                                </a>
                            
                            </div>
                        
                    
                
            </div>
        </div>
    </div>
    

    <div id="exploit-center-inner" class="w-full h-screen overflow-y-auto px-6 py-3" data-pagefind-body="">
        <article>
            <div class="w-full p-4">
                <h1 id="exploit-title" class="text-4xl font-bold">Subdomain Takeover</h1>

                <p class="my-3 text-base">Last modified: 2023-06-24</p>
                <div class="my-3 flex flex-wrap items-end space-x-2 space-y-2">
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Reconnaissance</span>
                    
                </div>
            </div>

            <hr class="border-1 border-white opacity-40">

            <p class="px-2 py-4 text-base">Subdomain Takeover is a malicious activity that the victim’s subdomain allows attackers to control and impersonate.</p>

            <div id="exploit-content" class="px-2 py-4 text-base">
                <h2 id="automation" tabindex="-1"><a href="#automation" class="header-anchor">Automation</a></h2>
<ul>
<li>
<p><a href="https://github.com/punk-security/dnsReaper">dnsReaper</a></p>
<pre class="codecopy_pre codecopy_pre_0"><code class="language-bash hljs">git <span class="syntax-built_in">clone</span> https://github.com/punk-security/dnsReaper.git
<span class="syntax-built_in">cd</span> dnsReaper
python3 -m venv venv
<span class="syntax-built_in">source</span> venv/bin/activate
pip3 install -r requirements.txt

<span class="syntax-comment"># Fetching from AWS</span>
python3 main.py aws --aws-access-key-id AWS_ACCESS_KEY_ID --domain example.com
<span class="syntax-comment"># Fetching from Azure</span>
python3 main.py azure --az-subscription-id AZ_SUBSCRIPTION_ID --domain example.com
<span class="syntax-comment"># Reading BIND zone file</span>
python3 main.py <span class="syntax-built_in">bind</span> --bind-zone-file /path/to/zone/file --domain example.com
<span class="syntax-comment"># Fetching from Cloudflare</span>
python3 main.py cloudflare --cloudflare-token CLOUDFLARE_TOKEN --domain example.com
<span class="syntax-comment"># Fetching from DigitalOcean</span>
python3 main.py digitalocean --do-api-key DO_API_KEY --domain example.com
<span class="syntax-comment"># Reading specific file</span>
python3 main.py file --filename /path/to/file --domain example.com
<span class="syntax-comment"># Scanning a single domain</span>
python3 main.py singla --domain example.com --domain example.com
</code><button class="codecopy_copy" data-codecopy="0">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
</li>
</ul>
<br>
<h2 id="testing---a%2C-cname-subdomain-takeover" tabindex="-1"><a href="#testing---a%2C-cname-subdomain-takeover" class="header-anchor">Testing - A, CNAME Subdomain Takeover</a></h2>
<h3 id="1.-enumerate-subdomains" tabindex="-1"><a href="#1.-enumerate-subdomains" class="header-anchor">1. Enumerate Subdomains</a></h3>
<p>There are various ways to enumerate subdomains.</p>
<pre class="codecopy_pre codecopy_pre_1"><code class="language-bash hljs">subfinder -d example.com

<span class="syntax-comment"># https://github.com/darkoperator/dnsrecon</span>
./dnsrecon.py -d example.com
</code><button class="codecopy_copy" data-codecopy="1">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Please refer to <a href="/exploit/reconnaissance/subdomain-discovery/">Subdomain Discovery</a> to check more details.</p>
<h3 id="2.-identify-misconfigurations-for-subdomains" tabindex="-1"><a href="#2.-identify-misconfigurations-for-subdomains" class="header-anchor">2. Identify Misconfigurations for Subdomains</a></h3>
<p>Check DNS records for identifying what’s on the destination of the subdomain.</p>
<pre class="codecopy_pre codecopy_pre_2"><code class="language-bash hljs">dig A app.example.com
dig CNAME app.example.com
</code><button class="codecopy_copy" data-codecopy="2">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Also we can try to access them with web browser or command-line. For example,</p>
<pre class="codecopy_pre codecopy_pre_3"><code class="language-bash hljs"><span class="syntax-comment"># -L: Follow redirect</span>
<span class="syntax-comment"># -v: Verbose mode</span>
curl -Lv app.example.com
curl -v cloud.example.com
curl -v mail.example.com
</code><button class="codecopy_copy" data-codecopy="3">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="3.-spoof-with-the-subdomain" tabindex="-1"><a href="#3.-spoof-with-the-subdomain" class="header-anchor">3. Spoof with the Subdomain</a></h3>
<p>If a certain subdomain can be accessible but the error page of the specific provider (e.g. GitHub, Google Cloud, Wix, etc.)  appeared, it means that the subdomain of the settings in the service provider was removed but the DNS record (e.g. A, CNAME) remains yet.</p>
<p>In short, attackers can spoof as a legitimate site by claiming this subdomain in the provider.</p>
<p>Here’s an abstract example:</p>
<ol>
<li>Login the target provider.</li>
<li>Create a malicious website.</li>
<li>Add the target subdomain (e.g. app.example.com) as custom domain in the setting page.</li>
<li>If users visit app.example.com, they have now visited a malicious website created by an attacker.</li>
</ol>
<br>
<h2 id="testing---ns-subdomain-takeover" tabindex="-1"><a href="#testing---ns-subdomain-takeover" class="header-anchor">Testing - NS Subdomain Takeover</a></h2>
<p>It’s more dangerous If NS record is vulnerable because if the nameserver is taken over, an attacker can take full control of victim’s domains.</p>
<p>To gather NS records for the target domain, use <code>dig</code> command.</p>
<pre class="codecopy_pre codecopy_pre_4"><code class="language-bash hljs">dig ns example.com +short

<span class="syntax-comment"># Result examples</span>
ns-100.abcde.org
ns-120.abcde.co.uk
</code><button class="codecopy_copy" data-codecopy="4">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Next, check if the gathered domains can be purchased with domain name registrar like GoDaddy, NameCheap.</p>
<p>For example, search <code>[abcde.org](http://abcde.org)</code> in the domain search page of NameCheap. If this domain can be purchased, attackers can buy this domain then take control the name resolution of a victim by creating the custom nameserver which pointed to this domain.</p>

            </div>
            <div class="my-6 p-4">
                <h2 class="text-3xl font-bold border-b-[1px] border-pink-dark">References</h2>
                <ul class="my-6 ml-4 list-disc">
                    
                        <li class="my-2">
                            <a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover" class="text-base text-pink-light hover:brightness-200">https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/10-Test_for_Subdomain_Takeover</a>
                        </li>
                    
                </ul>
            </div>
        </article>
    </div>

    
    <div id="exploit-rightside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-2 py-3">
        <div class="">
            <div class="">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">Tools by Muhammd</h4>
                <div class="my-4">
                    <div class="my-2">
                        <a href="https://github.com/muhammd/muhammd" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            RedTeam Repos
                        </a>
                        <p class="text-sm">Automatic PenTest Scripts</p>
                    </div>
                    <div class="my-2">
                        <a href="https://github.com/muhammd/autorecon" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            AutoRecon
                        </a>
                        <p class="text-sm">Auto reconnaissance CLI.</p>
                    </div>
                    <div class="my-2">
                        <a href="https://PenTest.Tools/" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            PenTest Tools 
                        </a>
                        <p class="text-sm">PenTest Tools</p>
                    </div>
                </div>
            </div>
            <div class="mt-8">
                
                <script async="" type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDE53L&amp;placement=exploit-noteshdksorg" id="_carbonads_js">
                </script>
            </div>
        </div>
    </div>
    
</div>
        </main>

        <footer class="w-full p-8 z-100 bg-navy-light">
            <div class="w-full flex flex-col items-center space-y-2 text-base">
                <div class="flex items-center justify-center space-x-2">
                    <a href="/disclaimer" class="text-pink-light hover:brightness-200">Disclaimer</a>
                    <a href="/privacy-policy" class="text-pink-light hover:brightness-200">Privacy Policy</a>
                </div>
                <hr class="w-[260px] white opacity-30">
                <div class="flex items-center space-x-2">
                    <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        GitHub
                    </a>            
                    <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        Twitter
                    </a>
                </div>
            </div>
        </footer>
    

</body></html>