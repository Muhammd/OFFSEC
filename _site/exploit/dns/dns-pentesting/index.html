<!DOCTYPE html>
<html lang="en" class="m-0 p-0 w-screen min-h-screen bg-navy-dark"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>DNS (Domain Name Systems) Pentesting | OffSec Wiki</title>
        <meta name="description" content="DNS is often called as a phonebook for internet. A default port is 53.">
        
        <link rel="icon" type="image/x-icon" href="/img/favicon-32.png">
        <link rel="stylesheet" href="/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/styles.css">
        <link rel="stylesheet" href="/css/carbonads.css">
        
        <script type="text/javascript" src="/js/exploit.js"></script>
        

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@muhammdhaidari">
        <meta name="twitter:creator" content="@muhammdhaidari">
        <meta property="og:url" content="https://offsec.PenTest.tools/exploit/dns/dns-pentesting/">
        <meta property="og:title" content="DNS (Domain Name Systems) Pentesting | OffSec Wiki">
        <meta property="og:description" content="DNS is often called as a phonebook for internet. A default port is 53.">
        <meta property="og:image" content="https://offsec.PenTest.tools/img/screenshot.png">
        
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-RR6XYHYTQ9"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RR6XYHYTQ9');
        </script>
    <script type="text/javascript" src="/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded', () => { new PagefindUI({"element":"#search","showImages":false,"showEmptyFilters":true,"resetStyles":true,"bundlePath":"/pagefind/","baseUrl":"/"}); });</script><link rel="stylesheet" href="/codecopy/codecopy.css"><script type="text/javascript" src="/codecopy/codecopy.js"></script></head>

    <body class="m-0 p-0 w-screen min-h-screen text-basic text-white text-sm">

        <header class="sticky top-0 w-full h-[70px] z-20 bg-gradient-to-r from-pink-dark">
    <div class="mx-auto w-full sm:w-2/3 h-full flex justify-around items-center">
        <div class="w-full h-full p-2 flex items-center space-x-3">
            <a href="/" class="hidden sm:block">
                <span class="text-base text-white font-bold">OFFSEC Wiki</span>
            </a>
            
            <div id="search"></div>
        </div>

        
        <div class="hidden sm:flex w-full h-full p-2 items-center justify-center space-x-3">
            
            <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" alt="GitHub">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-white w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>
            </a>
            
            <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" alt="Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-sky w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"></path></svg>
            </a>
        </div>
    </div>
</header>

<div id="search_bg" class="fixed top-0 left-0 w-full z-10 h-full bg-black opacity-50 hidden"></div>


<script>
    window.addEventListener('DOMContentLoaded', () => {
        //Display the black filter when searching
        const searchBgElem = document.getElementById("search_bg");
        const drawerElem = document.querySelector(".pagefind-ui__drawer");
        const inputElem = document.querySelector(".pagefind-ui__search-input");

        if (searchBgElem) {
            searchBgElem.addEventListener('click', () => {
                searchBgElem.classList.add("hidden");
                drawerElem.style.visibility = "hidden";
                drawerElem.style.opacity = 0;
            });
        }

        inputElem.addEventListener('focus', () => {
            if (searchBgElem) {
                searchBgElem.classList.remove("hidden");
                drawerElem.style.visibility = "visible";
                drawerElem.style.opacity = 1;
            }
        });
    });
</script>

        <main class="w-full h-full">
            <div class="block sm:grid grid-cols-[320px_minmax(400px,_1fr)_280px] py-2">

    
    <div id="exploit-leftside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3">
        <div class="w-full">
            <div id="exploit-related">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">
                    Exploits related to Dns
                </h4>
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Others</h4>
                    

                    
                        
                            <div class="my-3">
                            
                                <span id="scroll-target" class="text-sm text-white">DNS (Domain Name Systems) Pentesting</span>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/dns/subdomain-takeover/" class="text-sm text-pink-light hover:brightness-200">
                                    Subdomain Takeover
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/dns/multicast-dns-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                    mDNS (Multicast DNS) Pentesting
                                </a>
                            
                            </div>
                        
                    
                
            </div>
        </div>
    </div>
    

    <div id="exploit-center-inner" class="w-full h-screen overflow-y-auto px-6 py-3" data-pagefind-body="">
        <article>
            <div class="w-full p-4">
                <h1 id="exploit-title" class="text-4xl font-bold">DNS (Domain Name Systems) Pentesting</h1>

                <p class="my-3 text-base">Last modified: 2023-05-19</p>
                <div class="my-3 flex flex-wrap items-end space-x-2 space-y-2">
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Privilege Escalation</span>
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Reconnaissance</span>
                    
                </div>
            </div>

            <hr class="border-1 border-white opacity-40">

            <p class="px-2 py-4 text-base">DNS is often called as a phonebook for internet. A default port is 53.</p>

            <div id="exploit-content" class="px-2 py-4 text-base">
                <h2 id="enumeration" tabindex="-1"><a href="#enumeration" class="header-anchor">Enumeration</a></h2>
<p>You can use <strong>Nmap</strong> to enumerate automatically.</p>
<pre class="codecopy_pre codecopy_pre_0"><code class="language-sh hljs language-bash">nmap --script dns-nsec-enum --script-args dns-nsec-enum.domains vulnerable.com -p 53 &lt;target-ip&gt;
nmap --script dns-random-srcport -p 53 &lt;target-ip&gt;
nmap --script dns-recursion -p 53 &lt;target-ip&gt;
nmap --script dns-service-discovery -p 53 &lt;target-ip&gt;
nmap --script dns-* -p 53 &lt;target-ip&gt;

nmap -n --script <span class="syntax-string">"(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport"</span> &lt;target-ip&gt;
</code><button class="codecopy_copy" data-codecopy="0">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="investigation" tabindex="-1"><a href="#investigation" class="header-anchor">Investigation</a></h2>
<p><strong><a href="https://dnsdumpster.com/">DNSdumpster</a></strong> is an online tool for reconnaissance DNS records.</p>
<h3 id="ip-address-from-the-domain" tabindex="-1"><a href="#ip-address-from-the-domain" class="header-anchor">IP Address from the Domain</a></h3>
<pre class="codecopy_pre codecopy_pre_1"><code class="language-sh hljs language-bash">host example.com
</code><button class="codecopy_copy" data-codecopy="1">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="dns-records" tabindex="-1"><a href="#dns-records" class="header-anchor">DNS Records</a></h3>
<p><strong>Dig</strong> is a command-line tool for querying the Domain Name System.</p>
<pre class="codecopy_pre codecopy_pre_2"><code class="language-sh hljs language-bash"><span class="syntax-comment"># ANY record</span>
dig any example.com @&lt;target-ip&gt;
dig any @&lt;target-ip&gt; example.com
dig example.com any +nocmd +noall +answer

<span class="syntax-comment"># NS (nameserver) record</span>
dig ns example.com

<span class="syntax-comment"># TXT record</span>
dig txt example.com


<span class="syntax-comment"># Specify a public DNS server</span>
<span class="syntax-comment"># Cloudflare</span>
dig example.com @1.1.1.1
<span class="syntax-comment"># Google</span>
dig example.com @8.8.8.8
<span class="syntax-comment"># Quad9</span>
dig example.com @9.9.9.9
</code><button class="codecopy_copy" data-codecopy="2">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="zone-transfer" tabindex="-1"><a href="#zone-transfer" class="header-anchor">Zone Transfer</a></h3>
<p>The zone transfer is the process of copying the zone file on a primary DNS server to a secondary DNS server.</p>
<pre class="codecopy_pre codecopy_pre_3"><code class="language-sh hljs language-bash"><span class="syntax-comment"># axfr: Check if the Full Zone Transfer (AXFR) is available</span>
dig axfr @&lt;nameserver&gt;
dig axfr example.com @&lt;nameserver&gt;
dig axfr example.com @example.com
dig axfr &lt;zone-name&gt; @&lt;nameserver&gt;
</code><button class="codecopy_copy" data-codecopy="3">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="bind" tabindex="-1"><a href="#bind" class="header-anchor">BIND</a></h2>
<p>BIND is the most commonly used DNS server.</p>
<pre class="codecopy_pre codecopy_pre_4"><code class="language-bash hljs"><span class="syntax-comment"># BIND version</span>
dig @&lt;nameserver&gt; chaos txt version.bind
</code><button class="codecopy_copy" data-codecopy="4">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="configuration-files" tabindex="-1"><a href="#configuration-files" class="header-anchor">Configuration Files</a></h3>
<pre class="codecopy_pre codecopy_pre_5"><code class="language-sh hljs language-bash"><span class="syntax-comment"># Linux</span>
/etc/bind/named.conf
/etc/bind/named.conf.options
/etc/bind/named.conf.local
/etc/bind/named.conf.default-zones
</code><button class="codecopy_copy" data-codecopy="5">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="update-dns-zone" tabindex="-1"><a href="#update-dns-zone" class="header-anchor">Update DNS Zone</a></h3>
<p>If we found the secret key such like below, we can update DNS zone.</p>
<pre class="codecopy_pre codecopy_pre_6"><code class="language-bash hljs"><span class="syntax-comment"># /etc/bind/named.conf</span>

key <span class="syntax-string">"rndc-key"</span> {
    algorithm hmac-sha256;
    secret <span class="syntax-string">"zBatC828gunRa...bA="</span>;
};
</code><button class="codecopy_copy" data-codecopy="6">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>To update, run the following command using the key.</p>
<pre class="codecopy_pre codecopy_pre_7"><code class="language-bash hljs"><span class="syntax-comment"># -d: Debug mode</span>
<span class="syntax-comment"># -y: Set the literal TSIG (Transaction Signature) authentication key.</span>
nsupdate -d -y hmac-sha256:rndc-key:zBatC828gunRa...bA= 
Creating key...
namefromtext
keycreate
<span class="syntax-comment"># Enter target domain</span>
&gt; server example.com
<span class="syntax-comment"># Enter the new record</span>
<span class="syntax-comment"># 86400: The TTL (Time-To-Live) for the DNS record. Set 86400 seconds (24 hours) here.</span>
<span class="syntax-comment"># IN: Internet</span>
<span class="syntax-comment"># A: A record</span>
<span class="syntax-comment"># 10.0.0.1: Set your local ip address</span>
&gt; update add sub.example.com 86400 IN A 10.0.0.1
&gt; send
Reply from SOA query:

...

</code><button class="codecopy_copy" data-codecopy="7">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="reverse-lookup" tabindex="-1"><a href="#reverse-lookup" class="header-anchor">Reverse Lookup</a></h2>
<p>Resolves a domain name from given IP address.</p>
<pre class="codecopy_pre codecopy_pre_8"><code class="language-sh hljs language-bash">dig -x &lt;ip&gt;
dig -x 8.8.8.8
</code><button class="codecopy_copy" data-codecopy="8">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="resolve-domains-and-ip-addresses-in-%2Fetc%2Fhosts" tabindex="-1"><a href="#resolve-domains-and-ip-addresses-in-%2Fetc%2Fhosts" class="header-anchor">Resolve Domains and IP Addresses in /etc/hosts</a></h2>
<p>Edit <strong>/etc/hosts</strong> file as root to add custom domains.</p>
<pre class="codecopy_pre codecopy_pre_9"><code class="language-sh hljs language-bash">127.0.0.1  localhost

<span class="syntax-comment"># Add the custom domain</span>
10.0.0.2  vulnerable.com sub.vulnerable.com
10.0.0.3  vulnerable2.com
</code><button class="codecopy_copy" data-codecopy="9">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>If you want to force the system to reflect the changes, restart hostnamed.</p>
<pre class="codecopy_pre codecopy_pre_10"><code class="language-sh hljs language-bash">sudo systemctl restart systemd-hostnamed
</code><button class="codecopy_copy" data-codecopy="10">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="resolve-nameservers-in-%2Fetc%2Fresolv.conf" tabindex="-1"><a href="#resolve-nameservers-in-%2Fetc%2Fresolv.conf" class="header-anchor">Resolve Nameservers in /etc/resolv.conf</a></h2>
<p>Edit <strong>/etc/resolv.conf</strong> file as root to add custom nameservers.</p>
<pre class="codecopy_pre codecopy_pre_11"><code class="language-sh hljs language-bash"><span class="syntax-comment"># Google nameservers</span>
nameserver 8.8.8.8
nameserver 8.8.4.4

<span class="syntax-comment"># Google nameservers (IPv6)</span>
nameserver 2001:4860:4860::8888
nameserver 2001:4860:4860::8844
</code><button class="codecopy_copy" data-codecopy="11">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>If you want to force the system to reflect the changes, restart resolved.</p>
<pre class="codecopy_pre codecopy_pre_12"><code class="language-sh hljs language-bash">sudo systemctl restart systemd-resolved.service
</code><button class="codecopy_copy" data-codecopy="12">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="dns-spoofing" tabindex="-1"><a href="#dns-spoofing" class="header-anchor">DNS Spoofing</a></h2>
<p>Also known as DNS cache poisoning. It corrupts Domain Name System data is introduced into the DNS resolver's cache, causing the name server to return an incorrect result record, e.g. an IP address.</p>
<br>
<h2 id="flush-the-dns-cache" tabindex="-1"><a href="#flush-the-dns-cache" class="header-anchor">Flush the DNS Cache</a></h2>
<p>Clear IP addresses or DNS records from caches.</p>
<pre class="codecopy_pre codecopy_pre_13"><code class="language-sh hljs language-bash">sudo resolvectl flush-caches
<span class="syntax-comment"># or</span>
sudo systemd-resolve --flush-cache
</code><button class="codecopy_copy" data-codecopy="13">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Check DNS caches are actually flushed</p>
<pre class="codecopy_pre codecopy_pre_14"><code class="language-sh hljs language-bash">sudo resolvectl statistics
<span class="syntax-comment"># or</span>
sudo systemd-resolve --statistics
</code><button class="codecopy_copy" data-codecopy="14">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="dns-exfiltration" tabindex="-1"><a href="#dns-exfiltration" class="header-anchor">DNS Exfiltration</a></h2>
<p><strong><a href="https://github.com/kleosdc/dns-exfil-infil">dns-exfil-infil</a></strong></p>
<br>
<h2 id="dns-infiltration" tabindex="-1"><a href="#dns-infiltration" class="header-anchor">DNS Infiltration</a></h2>
<p>Coming soon...</p>
<br>
<h2 id="dns-tunneling" tabindex="-1"><a href="#dns-tunneling" class="header-anchor">DNS Tunneling</a></h2>
<p><strong><a href="https://github.com/yarrick/iodine">Iodine</a></strong></p>

            </div>
        </article>
    </div>

    
    <div id="exploit-rightside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-2 py-3">
        <div class="">
            <div class="">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">Tools by Muhammd</h4>
                <div class="my-4">
                    <div class="my-2">
                        <a href="https://github.com/muhammd/muhammd" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            RedTeam Repos
                        </a>
                        <p class="text-sm">Automatic PenTest Scripts</p>
                    </div>
                    <div class="my-2">
                        <a href="https://github.com/muhammd/autorecon" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            AutoRecon
                        </a>
                        <p class="text-sm">Auto reconnaissance CLI.</p>
                    </div>
                    <div class="my-2">
                        <a href="https://PenTest.Tools/" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            PenTest Tools 
                        </a>
                        <p class="text-sm">PenTest Tools</p>
                    </div>
                </div>
            </div>
            <div class="mt-8">
                
                <script async="" type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDE53L&amp;placement=exploit-noteshdksorg" id="_carbonads_js">
                </script>
            </div>
        </div>
    </div>
    
</div>
        </main>

        <footer class="w-full p-8 z-100 bg-navy-light">
            <div class="w-full flex flex-col items-center space-y-2 text-base">
                <div class="flex items-center justify-center space-x-2">
                    <a href="/disclaimer" class="text-pink-light hover:brightness-200">Disclaimer</a>
                    <a href="/privacy-policy" class="text-pink-light hover:brightness-200">Privacy Policy</a>
                </div>
                <hr class="w-[260px] white opacity-30">
                <div class="flex items-center space-x-2">
                    <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        GitHub
                    </a>            
                    <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        Twitter
                    </a>
                </div>
            </div>
        </footer>
    

</body></html>