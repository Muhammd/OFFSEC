<!DOCTYPE html>
<html lang="en" class="m-0 p-0 w-screen min-h-screen bg-navy-dark"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Malware Detection on Windows | OffSec Wiki</title>
        <meta name="description" content="This page demonstrates how to check if our Windows PC is compromised.">
        
        <link rel="icon" type="image/x-icon" href="/img/favicon-32.png">
        <link rel="stylesheet" href="/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/styles.css">
        <link rel="stylesheet" href="/css/carbonads.css">
        
        <script type="text/javascript" src="/js/exploit.js"></script>
        

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@muhammdhaidari">
        <meta name="twitter:creator" content="@muhammdhaidari">
        <meta property="og:url" content="https://offsec.PenTest.tools/exploit/malware/malware-detection-on-windows/">
        <meta property="og:title" content="Malware Detection on Windows | OffSec Wiki">
        <meta property="og:description" content="This page demonstrates how to check if our Windows PC is compromised.">
        <meta property="og:image" content="https://offsec.PenTest.tools/img/screenshot.png">
        
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-RR6XYHYTQ9"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RR6XYHYTQ9');
        </script>
    <script type="text/javascript" src="/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded', () => { new PagefindUI({"element":"#search","showImages":false,"showEmptyFilters":true,"resetStyles":true,"bundlePath":"/pagefind/","baseUrl":"/"}); });</script><link rel="stylesheet" href="/codecopy/codecopy.css"><script type="text/javascript" src="/codecopy/codecopy.js"></script></head>

    <body class="m-0 p-0 w-screen min-h-screen text-basic text-white text-sm">

        <header class="sticky top-0 w-full h-[70px] z-20 bg-gradient-to-r from-pink-dark">
    <div class="mx-auto w-full sm:w-2/3 h-full flex justify-around items-center">
        <div class="w-full h-full p-2 flex items-center space-x-3">
            <a href="/" class="hidden sm:block">
                <span class="text-base text-white font-bold">OFFSEC Wiki</span>
            </a>
            
            <div id="search"></div>
        </div>

        
        <div class="hidden sm:flex w-full h-full p-2 items-center justify-center space-x-3">
            
            <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" alt="GitHub">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-white w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>
            </a>
            
            <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" alt="Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-sky w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"></path></svg>
            </a>
        </div>
    </div>
</header>

<div id="search_bg" class="fixed top-0 left-0 w-full z-10 h-full bg-black opacity-50 hidden"></div>


<script>
    window.addEventListener('DOMContentLoaded', () => {
        //Display the black filter when searching
        const searchBgElem = document.getElementById("search_bg");
        const drawerElem = document.querySelector(".pagefind-ui__drawer");
        const inputElem = document.querySelector(".pagefind-ui__search-input");

        if (searchBgElem) {
            searchBgElem.addEventListener('click', () => {
                searchBgElem.classList.add("hidden");
                drawerElem.style.visibility = "hidden";
                drawerElem.style.opacity = 0;
            });
        }

        inputElem.addEventListener('focus', () => {
            if (searchBgElem) {
                searchBgElem.classList.remove("hidden");
                drawerElem.style.visibility = "visible";
                drawerElem.style.opacity = 1;
            }
        });
    });
</script>

        <main class="w-full h-full">
            <div class="block sm:grid grid-cols-[320px_minmax(400px,_1fr)_280px] py-2">

    
    <div id="exploit-leftside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3">
        <div class="w-full">
            <div id="exploit-related">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">
                    Exploits related to Malware
                </h4>
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Others</h4>
                    

                    
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/antivirus-evasion/" class="text-sm text-pink-light hover:brightness-200">
                                    AV (Antivirus) Evasion
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/libreoffice-macros/" class="text-sm text-pink-light hover:brightness-200">
                                    LibreOffice Macros
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/maldoc-analysis/" class="text-sm text-pink-light hover:brightness-200">
                                    Maldoc Analysis
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/malware-analysis/" class="text-sm text-pink-light hover:brightness-200">
                                    Malware Analysis
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <span id="scroll-target" class="text-sm text-white">Malware Detection on Windows</span>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/malware-dynamic-analysis-with-remnux/" class="text-sm text-pink-light hover:brightness-200">
                                    Malware Dynamic Analysis with REMnux
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/malware-static-analysis/" class="text-sm text-pink-light hover:brightness-200">
                                    Malware Static Analysis
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/npm-supply-chain-attack/" class="text-sm text-pink-light hover:brightness-200">
                                    NPM Supply Chain Attack
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/sigma-rules/" class="text-sm text-pink-light hover:brightness-200">
                                    Sigma Rules
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/splunk-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                    Splunk Pentesting
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/malware/url-defanging/" class="text-sm text-pink-light hover:brightness-200">
                                    URL Defanging
                                </a>
                            
                            </div>
                        
                    
                
            </div>
        </div>
    </div>
    

    <div id="exploit-center-inner" class="w-full h-screen overflow-y-auto px-6 py-3" data-pagefind-body="">
        <article>
            <div class="w-full p-4">
                <h1 id="exploit-title" class="text-4xl font-bold">Malware Detection on Windows</h1>

                <p class="my-3 text-base">Last modified: 2023-08-05</p>
                <div class="my-3 flex flex-wrap items-end space-x-2 space-y-2">
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Malware</span>
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Windows</span>
                    
                </div>
            </div>

            <hr class="border-1 border-white opacity-40">

            <p class="px-2 py-4 text-base">This page demonstrates how to check if our Windows PC is compromised.</p>

            <div id="exploit-content" class="px-2 py-4 text-base">
                <h2 id="checking-established-network" tabindex="-1"><a href="#checking-established-network" class="header-anchor">Checking Established Network</a></h2>
<p>This process refers to <a href="https://www.makeuseof.com/check-windows-pc-has-been-hacked/">this article</a>. Please see it for more details.</p>
<h3 id="1.-list-network-processes" tabindex="-1"><a href="#1.-list-network-processes" class="header-anchor">1. List Network Processes</a></h3>
<p>What first we need to check is to see the network status on Command Prompt.</p>
<pre class="codecopy_pre codecopy_pre_0"><code class="language-bash hljs"><span class="syntax-comment"># -a: Show all connections</span>
<span class="syntax-comment"># -n: Show ip addresses and ports as number</span>
<span class="syntax-comment"># -o: Show process ID</span>
netstat -ano
</code><button class="codecopy_copy" data-codecopy="0">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Especially, <strong>"ESTABLISHED"</strong> status might be suspicious to be connected attackers server. So we need to investigate the IP address which is connected with our machine.</p>
<p>Let's OSINT.</p>
<h3 id="2.-check-suspicious-ip-address-with-osint" tabindex="-1"><a href="#2.-check-suspicious-ip-address-with-osint" class="header-anchor">2. Check Suspicious IP Address with OSINT</a></h3>
<p>Copy the ip address and paste it into IP lookup site like <a href="https://www.iplocation.net/ip-lookup">iplocation.net</a>. Then check who owns that ip address. If the famous (reliable) organization owns it, we may be relax. However, unknown organization or individual owns it, we have to doubt this ip. So paste the ip address into <a href="https://www.virustotal.com/gui/">VirusTotal</a> to check if it is an evil or not.</p>
<p>If the ip address is still suspicious, we need to do additional investigation.</p>
<h3 id="3.-check-suspicious-process" tabindex="-1"><a href="#3.-check-suspicious-process" class="header-anchor">3. Check Suspicious Process</a></h3>
<ol>
<li>Copy the PID at the right of <strong>"ESTABLISHED"</strong> in suspicious line in <strong>Command Prompt</strong>.</li>
<li>Open <strong>Task Manager</strong> and click <strong>Details</strong> section in the left side menu.</li>
<li>On <strong>Task Manger</strong>, put the <strong>PID</strong> into the search field, then find target process.</li>
<li>Right-click on the process and go to <strong>Properties</strong>. Then check the program details in <strong>Details</strong> tab.</li>
</ol>
<h3 id="4.-remove-suspicious-file-which-is-doing-the-process" tabindex="-1"><a href="#4.-remove-suspicious-file-which-is-doing-the-process" class="header-anchor">4. Remove Suspicious File which is Doing the Process</a></h3>
<ol>
<li>On <strong>Task Manager</strong>, right-click on the suspicious process then click Open File Location.</li>
<li>In <strong>Windows Explorer</strong>, delete the file after checking this file is really not innecent file associated with our Windows machine.</li>
</ol>

            </div>
            <div class="my-6 p-4">
                <h2 class="text-3xl font-bold border-b-[1px] border-pink-dark">References</h2>
                <ul class="my-6 ml-4 list-disc">
                    
                        <li class="my-2">
                            <a href="https://www.makeuseof.com/check-windows-pc-has-been-hacked/" class="text-base text-pink-light hover:brightness-200">https://www.makeuseof.com/check-windows-pc-has-been-hacked/</a>
                        </li>
                    
                </ul>
            </div>
        </article>
    </div>

    
    <div id="exploit-rightside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-2 py-3">
        <div class="">
            <div class="">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">Tools by Muhammd</h4>
                <div class="my-4">
                    <div class="my-2">
                        <a href="https://github.com/muhammd/muhammd" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            RedTeam Repos
                        </a>
                        <p class="text-sm">Automatic PenTest Scripts</p>
                    </div>
                    <div class="my-2">
                        <a href="https://github.com/muhammd/autorecon" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            AutoRecon
                        </a>
                        <p class="text-sm">Auto reconnaissance CLI.</p>
                    </div>
                    <div class="my-2">
                        <a href="https://PenTest.Tools/" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            PenTest Tools 
                        </a>
                        <p class="text-sm">PenTest Tools</p>
                    </div>
                </div>
            </div>
            <div class="mt-8">
                
                <script async="" type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDE53L&amp;placement=exploit-noteshdksorg" id="_carbonads_js">
                </script>
            </div>
        </div>
    </div>
    
</div>
        </main>

        <footer class="w-full p-8 z-100 bg-navy-light">
            <div class="w-full flex flex-col items-center space-y-2 text-base">
                <div class="flex items-center justify-center space-x-2">
                    <a href="/disclaimer" class="text-pink-light hover:brightness-200">Disclaimer</a>
                    <a href="/privacy-policy" class="text-pink-light hover:brightness-200">Privacy Policy</a>
                </div>
                <hr class="w-[260px] white opacity-30">
                <div class="flex items-center space-x-2">
                    <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        GitHub
                    </a>            
                    <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        Twitter
                    </a>
                </div>
            </div>
        </footer>
    

</body></html>